<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Create and publish powershell module - eeLhpesoJ - Engineering blog</title>
<meta name="description" content="0. Overview In this post, I will create my own custom powershell module and publish to PSGallery. Itâ€™s really easy. Letâ€™s find out.">


  <meta name="author" content="Joseph Lee">
  
  <meta property="article:author" content="Joseph Lee">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="eeLhpesoJ - Engineering blog">
<meta property="og:title" content="Create and publish powershell module">
<meta property="og:url" content="http://localhost:4000/Create-and-Publish-PowerShell-Module/">


  <meta property="og:description" content="0. Overview In this post, I will create my own custom powershell module and publish to PSGallery. Itâ€™s really easy. Letâ€™s find out.">







  <meta property="article:published_time" content="2025-04-08T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/Create-and-Publish-PowerShell-Module/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="eeLhpesoJ - Engineering blog Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          eeLhpesoJ - Engineering blog
          
        </a>
        <ul class="visible-links"></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/" itemprop="item"><span itemprop="name">Home</span></a>

          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Create and publish powershell module</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/favicon/favicon-96x96.png" alt="Joseph Lee" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Joseph Lee</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>A full-stack engineering mindset</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Seoul, Korea</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/eelhpesoj/eelhpesoj.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/joseph-lee-870660260/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="mailto:leeyosebi@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i><span class="label">Contact Me: Joseph Lee</span></a></li>
          
        
          
            <li><a href="mailto:dobineer@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i><span class="label">Request Us: Engineering team</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Create and publish powershell module">
    <meta itemprop="description" content="0. OverviewIn this post, I will create my own custom powershell module and publish to PSGallery.Itâ€™s really easy. Letâ€™s find out.">
    <meta itemprop="datePublished" content="2025-04-08T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://localhost:4000/Create-and-Publish-PowerShell-Module/" itemprop="url">Create and publish powershell module
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-04-08T00:00:00+09:00">April 8, 2025</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-list"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#0-overview">0. Overview</a></li><li><a href="#1-create-function">1. Create function</a></li><li><a href="#2-create-api-key">2. Create API Key</a></li><li><a href="#3-publish-module">3. Publish Module</a></li><li><a href="#4-install-module-and-use">4. Install Module and Use</a></li><li><a href="#5-ref">5. Ref</a></li></ul>
            </nav>
          </aside>
        
        <h1 id="0-overview">0. Overview</h1>
<p>In this post, I will create my own custom powershell module and publish to PSGallery.
Itâ€™s really easy. Letâ€™s find out.</p>

<h1 id="1-create-function">1. Create function</h1>
<p>Obviously, we need to create module.
I just created a simple function like below.
And ensure that the extension should be <strong>.psm1</strong> when you save this ps1 file.
As you can see, itâ€™s for the used for module.</p>

<p>Quick description the function below:
Check the tenantâ€™s expiration date with admin account.
Because of the Graph module is not provide the created date, I think itâ€™s reasonable to check the admin account which is bulit in account when the demo tenant is created.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function </span>Test-DemoTenantValid <span class="o">{</span>
 
    Connect-MgGraph <span class="nt">-Scopes</span> <span class="s2">"User.Read.All"</span>
 
    <span class="nv">$adminUser</span> <span class="o">=</span> Get-MgUser <span class="nt">-All</span> <span class="nt">-Property</span> DisplayName, UserPrincipalName, CreatedDateTime |
        Where-Object <span class="o">{</span> <span class="nv">$_</span>.DisplayName <span class="nt">-eq</span> <span class="s2">"MOD Administrator"</span> <span class="o">}</span> |
        Select-Object <span class="nt">-First</span> 1 DisplayName, UserPrincipalName, CreatedDateTime
 
    <span class="nv">$TenantCreatedDateTime</span> <span class="o">=</span> <span class="nv">$adminUser</span>.CreatedDateTime
    <span class="nv">$TenantIsValidUntil</span> <span class="o">=</span> <span class="nv">$TenantCreatedDateTime</span>.AddDays<span class="o">(</span>90<span class="o">)</span>
    <span class="nv">$today</span> <span class="o">=</span> Get-Date
 
    <span class="k">if</span> <span class="o">(</span><span class="nv">$today</span> <span class="nt">-gt</span> <span class="nv">$TenantIsValidUntil</span><span class="o">)</span> <span class="o">{</span>
        Write-Host <span class="s2">"Your tenant is expired. It was valid until </span><span class="nv">$TenantIsValidUntil</span><span class="s2">"</span> <span class="nt">-ForegroundColor</span> Red
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        Write-Host <span class="s2">"Your tenant is still valid. It is valid until </span><span class="nv">$TenantIsValidUntil</span><span class="s2">"</span> <span class="nt">-ForegroundColor</span> Green
    <span class="o">}</span>
<span class="o">}</span>
 
</code></pre></div></div>

<h1 id="2-create-api-key">2. Create API Key</h1>
<p>To publish this module file to PSGallery, you need to sign in https://www.powershellgallery.com/ and create your secret API Key.
<img src="https://velog.velcdn.com/images/leeyosebi/post/04582bd4-0a7d-439c-835b-065b6fd70716/image.png" alt="" />
Move to Publish &gt; Click here.
<img src="https://velog.velcdn.com/images/leeyosebi/post/91499fb3-b809-4f74-9cef-cc422b6b44e2/image.png" alt="" />
Click Create
<img src="https://velog.velcdn.com/images/leeyosebi/post/562b726e-0355-4f89-9785-138e29e68ffc/image.png" alt="" />
<img src="https://velog.velcdn.com/images/leeyosebi/post/d31076a8-644b-4960-ad3c-5efb4f3067ea/image.png" alt="" />
Make sure to remember your key. If you forgot the key, itâ€™s totally fine. You can Regenerate the key.
<img src="https://velog.velcdn.com/images/leeyosebi/post/eb0c1249-83b3-4983-88a2-69345c5269f7/image.png" alt="" /></p>
<h1 id="3-publish-module">3. Publish Module</h1>
<p>Now we are all set to publish the module.
Oh make sure that the module should be in the directory.
And you need to make module manifest first
Use this cmdlet below which is excatlly the same as on the PSGallery&gt;Publish.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Execute 1</span>
New-ModuleManifest <span class="nt">-Path</span> <span class="s2">".</span><span class="se">\D</span><span class="s2">emoTenantIsValid</span><span class="se">\D</span><span class="s2">emoTenantIsValid.psd1"</span> <span class="sb">`</span>
    <span class="nt">-RootModule</span> <span class="s2">"DemoTenantIsValid.psm1"</span> <span class="sb">`</span>
    <span class="nt">-ModuleVersion</span> <span class="s2">"1.0.0"</span> <span class="sb">`</span>
    <span class="nt">-Author</span> <span class="s2">"Joseph"</span> <span class="sb">`</span>
    <span class="nt">-Description</span> <span class="s2">"first version."</span>

<span class="c"># Execute 2    </span>
Publish-Module <span class="nt">-Path</span> &lt;filePath&gt; <span class="nt">-NugetAPIKey</span> &lt;Your API Key&gt;
</code></pre></div></div>
<p>Your directory and files would be like this:
<img src="https://velog.velcdn.com/images/leeyosebi/post/053e5497-a1be-45ec-a679-7c7661c5999b/image.png" alt="" /></p>

<p>And here is my example when I execute the â€˜Execute 2â€™:
(I highly recommend to user PowerShell7)</p>

<p>The module has been uploaded to the gallery.
<img src="https://velog.velcdn.com/images/leeyosebi/post/7b4a1e03-b6e1-4122-9a21-a96d499dad56/image.png" alt="" />
After that, the package ID is displayed on my packages.
<img src="https://velog.velcdn.com/images/leeyosebi/post/7cd1830e-c65f-4f4c-8436-ad6d4ad78215/image.png" alt="" /></p>

<p>And also can searched on the public modules.
<img src="https://velog.velcdn.com/images/leeyosebi/post/a28f6688-a500-4747-8736-bb74c55fd371/image.png" alt="" /></p>

<h1 id="4-install-module-and-use">4. Install Module and Use</h1>
<p>Now that we publish to the public PowerShell Gallery, letâ€™s test to install module in other computers.</p>

<p>Open new powershell session and execute this command below.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Install-Module -Name DemoTenantIsValid
</code></pre></div></div>
<p><img src="https://velog.velcdn.com/images/leeyosebi/post/f9414583-5795-4a6f-8ae8-1b103ae195cf/image.png" alt="" /></p>

<p>Good the module has found in the PSGallery. Click â€˜Yes to Allâ€™
<img src="https://velog.velcdn.com/images/leeyosebi/post/cd423635-8ff6-44e1-bb49-760f48d84716/image.png" alt="" />
<img src="https://velog.velcdn.com/images/leeyosebi/post/bdfb673c-08f3-4935-b67a-4d2643dc487f/image.png" alt="" /></p>

<p>Once the module installed, you can check the module location on your local device with following command.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Module <span class="nt">-ListAvailable</span> <span class="nt">-Name</span> DemoTenantIsValid | Select-Object ModuleBase
</code></pre></div></div>
<p><img src="https://velog.velcdn.com/images/leeyosebi/post/cf669583-0c97-44df-87bd-b043a8d4ec1b/image.png" alt="" /></p>

<p>and the funtion that I made is displayed and can be used.
<img src="https://velog.velcdn.com/images/leeyosebi/post/a0b48973-71b9-4342-8256-511371e2a59a/image.png" alt="" /></p>

<p>The function works. It trys to connect mggraph which I put in the function.
<img src="https://velog.velcdn.com/images/leeyosebi/post/b3c78464-f233-443d-8ffa-e27d9421281f/image.png" alt="" /></p>

<p>Once you success to log in, it says your tenant is valid or not.
<img src="https://velog.velcdn.com/images/leeyosebi/post/4af98b85-c6a1-4736-af34-8efc943f220a/image.png" alt="" /></p>

<h1 id="5-ref">5. Ref</h1>
<ul>
  <li>https://learn.microsoft.com/en-us/powershell/gallery/how-to/publishing-packages/publishing-a-package?view=powershellget-3.x</li>
  <li>https://learn.microsoft.com/en-us/powershell/scripting/learn/ps101/09-functions?view=powershell-7.5</li>
  <li>https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-modulemanifest?view=powershell-7.5</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-04-08T00:00:00+09:00">April 8, 2025</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/Multiple-Domain-Support-for-Federating-with-Microsoft-Entra-ID/" class="pagination--pager" title="Multiple domain support for federating with microsoft entra id">Previous</a>
    
    
      <a href="/AD-CA-Setup-&-Sign-intune-PowerShell-Script/" class="pagination--pager" title="Ad ca setup &amp; sign intune powershell script">Next</a>
    
  </nav>


    </div>

    
      
        <p>
          Comments are configured with provider: <strong>utterances</strong>,
          but are disabled in non-production environments.
        </p>
      
    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Event-ID-1074-on-WinSvr-2022-Standard-Evaluation/" rel="permalink">Event id 1074 on winsvr 2022 standard evaluation
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-12-06T00:00:00+09:00">December 6, 2025</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Related post:

  https://velog.io/@leeyosebi/IIS-ARR-Configuration-with-ExSvr

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/IIS-ARR-Configuration-with-ExSvr/" rel="permalink">Iis arr configuration with exsvr
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-11-25T00:00:00+09:00">November 25, 2025</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Overview
For the exchange server, almote every clients will need to seperate the network traffic with 443 and 25.
In this case, they need reverse proxy. I wi...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Checking-Public-SSL-Certificate/" rel="permalink">Checking public ssl certificate
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-11-15T00:00:00+09:00">November 15, 2025</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Overview
Most of the cases, we need to check the ssl stream if the connection is funtioning properly or not.
To do this, I suggest the two options below.
In ...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Exchange-Hybrid-EWS-Dedicated-Hybrid-app/" rel="permalink">[exchange hybrid] ews â†’ dedicated hybrid app
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-09-18T00:00:00+09:00">September 18, 2025</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Overview
Dear all, this post will provide you an idea to go through retirement of EWS from exchange online. All of this content from refer following two docu...</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2025 <a href="https://eelhpesoj.github.io">Joseph Lee</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>


         <a href='http://www.freevisitorcounters.com'>free counters</a> <script type='text/javascript' src='https://www.freevisitorcounters.com/auth.php?id=66402066087668e96703a2b922d7eb610db76c45'></script>
<script type="text/javascript" src="https://www.freevisitorcounters.com/en/home/counter/1455696/t/5"></script>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'eelhpesoj/eelhpesoj.github.io');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('label', 'ðŸ’¬ comment');
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  





    
  </body>
</html>
